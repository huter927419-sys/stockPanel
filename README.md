# HaiLiDrvDemo 股票监控系统

## 项目概述
这是一个 C# Windows Forms 应用程序，用于实时监控股票行情数据。支持多板块管理，自动筛选和排序股票数据。

## 新功能特性
- ✅ 多板块管理：可创建多个自定义板块
- ✅ 股票管理：支持添加/删除/导入股票代码
- ✅ 智能筛选：只显示涨幅>3% 且 现价>开盘5% 的股票
- ✅ 自动排序：按涨幅从高到低排序
- ✅ 表格展示：使用 DataGridView 清晰展示数据
- ✅ 自动清除：每天开盘前自动清除前一天数据

## 运行要求

### 1. .NET Framework 运行时
项目基于 .NET Framework 2.0，需要安装：
- .NET Framework 2.0 或更高版本（Windows 10/11 通常已预装）

### 2. 必需的 DLL 文件
程序需要 `StockDrv.dll` 驱动文件才能正常运行。

**DLL 文件位置：**
- 程序会首先从注册表 `HKEY_LOCAL_MACHINE\SOFTWARE\StockDrv` 中查找 `Driver` 键值
- 如果注册表中没有，则从程序启动目录（`bin\Debug\`）查找 `StockDrv.dll`

**解决方案：**
1. 将 `StockDrv.dll` 文件复制到 `bin\Debug\` 目录
2. 或者在注册表中添加路径：
   - 打开注册表编辑器（regedit）
   - 导航到 `HKEY_LOCAL_MACHINE\SOFTWARE\StockDrv`
   - 创建字符串值 `Driver`，值为 DLL 的完整路径

## 编译和运行

### 使用 Visual Studio
1. 打开 `HaiLiDrvDemo.sln`
2. 确保 `StockDrv.dll` 在 `bin\Debug\` 目录中
3. 按 F5 运行或选择"生成" -> "生成解决方案"

### 直接运行
1. 确保 `StockDrv.dll` 在 `bin\Debug\` 目录中
2. 双击 `bin\Debug\HaiLiDrvDemo.exe`

## 功能说明

程序界面包含以下按钮：
- **启动接收**：加载 StockDrv.dll 并初始化股票数据接收
- **停止接收**：停止接收并卸载 DLL
- **退出应用**：关闭程序
- **取日线数据**：获取股票日线数据
- **取五分钟数据**：获取五分钟K线数据
- **取资料F10**：获取个股基本资料
- **取财经新闻**：获取财经新闻
- **停止补数**：中止数据补充
- **取分时数据**：获取分时数据
- **取分笔数据**：获取分笔数据
- **取除权数据**：获取除权数据
- **取财务数据**：获取财务数据

## 注意事项

1. **缺少 DLL 时的错误**：如果 `StockDrv.dll` 不存在，点击"启动接收"按钮会显示"装载驱动DLL失败，请检查！"
2. **平台目标**：项目配置为 x86 平台（32位），确保 DLL 也是 32 位版本
3. **数据接收**：程序通过 Windows 消息机制接收股票数据，数据会显示在列表框中

## 故障排除

### 问题：程序无法启动
- 检查是否安装了 .NET Framework 2.0 或更高版本
- 检查 `bin\Debug\HaiLiDrvDemo.exe` 是否存在

### 问题：提示"装载驱动DLL失败"
- 确认 `StockDrv.dll` 文件存在于 `bin\Debug\` 目录
- 检查 DLL 是否为 32 位版本（项目配置为 x86）
- 检查 DLL 是否损坏或版本不匹配

### 问题：点击按钮没有反应
- 确保已点击"启动接收"按钮成功加载 DLL
- 检查 DLL 中的函数导出是否正确

